server {
    listen 80;
    server_name api.example.com;

    location / {
        # 허용할 외부 IP
        # allow 123.45.67.89;
        # allow 111.222.333.0/24;   # CIDR 블록 예시

        # 로컬에서 오는 요청도 허용
        allow 127.0.0.1;
        allow ::1;

        # 나머지는 차단
        deny all;

        proxy_pass http://127.0.0.1:8080;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}

# sudo nano /etc/nginx/sites-available/acorn.conf
# sudo ln -s /etc/nginx/sites-available/acorn.conf /etc/nginx/sites-enabled/
